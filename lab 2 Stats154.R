# Elementary Statistics - STAT154
# Spring 2023 - Lab2
  # Duration 1000 data inputed as the x variable

    

x = c(27,2,22,37,52,50,3,54,32,41,4,6,2,56,67,16,3,71,36,2,2,17,7,0,1,68,67,4,4,70,38,64,1,21,60,29,1,2,74,14,5,88,7,64,43,4,31,16,55,16,15,30,30,15,13,6,54,5,56,27,19,57,59,49,2,40,38,55,37,20,5,44,2,20,11,68,1,5,29,36,50,55,30,73,19,56,16,70,1,47,1,49,2,64,61,44,2,34,15,39,24,13,1,73,0,21,9,14,61,26,40,8,33,6,19,48,1,40,1,30,1,54,21,67,64,49,5,27,45,11,20,3,1,20,66,55,34,50,5,1,42,26,37,56,20,4,17,5,7,33,55,2,21,7,20,3,1,41,27,2,8,51,52,36,27,27,44,19,36,54,1,57,29,12,48,1,51,36,41,31,16,22,8,1,51,12,11,16,48,1,48,56,27,59,1,54,51,21,40,3,1,12,27,3,3,78,10,8,16,2,31,0,5,33,23,17,3,42,2,9,39,2,4,20,50,49,27,4,32,16,62,63,52,61,50,60,3,20,19,62,42,52,1,44,1,28,75,11,1,2,48,45,12,64,59,22,32,2,48,19,25,54,12,1,37,34,2,29,62,23,32,1,52,37,23,31,1,48,51,35,49,88,50,31,11,54,84,1,71,65,74,1,16,16,60,33,24,38,47,33,1,2,81,39,77,50,38,8,50,17,37,47,27,52,2,29,12,63,35,49,9,20,37,44,4,6,23,36,41,26,21,50,7,2,33,61,50,31,27,48,1,58,41,41,10,4,17,17,36,61,2,47,43,2,3,59,42,8,40,45,2,4,74,3,22,23,12,45,1,2,18,21,2,19,50,2,36,50,32,3,32,1,16,20,27,1,45,47,21,24,10,41,49,58,16,1,15,38,87,39,50,2,74,1,49,30,1,67,2,31,49,44,43,21,28,1,32,19,66,34,1,17,17,31,8,17,3,51,42,17,9,1,20,15,4,30,5,34,51,46,35,1,8,0,1,3,8,15,29,23,1,52,3,63,41,28,28,42,0,20,23,68,37,59,56,49,13,12,39,26,30,51,18,40,42,19,37,5,41,38,5,7,1,5,30,24,1,44,43,20,1,4,35,64,1,11,42,56,60,15,20,27,2,50,40,5,26,43,4,81,2,9,15,24,1,49,46,56,60,48,1,1,22,3,56,1,3,41,82,17,11,1,57,2,48,13,60,1,3,22,47,1,54,1,2,80,74,2,64,4,1,6,67,54,46,22,40,21,30,43,15,11,2,1,36,81,33,2,33,50,53,2,40,16,28,18,1,57,29,1,14,0,45,19,1,5,2,17,2,13,33,25,14,48,25,35,49,44,3,23,24,2,23,2,86,64,19,53,90,13,3,48,35,73,64,34,1,39,39,34,76,28,0,36,4,23,56,48,17,1,37,56,29,57,71,1,41,74,25,41,1,13,8,84,29,51,22,63,52,37,18,34,62,25,13,36,58,48,2,28,51,18,30,35,1,20,35,16,27,43,18,20,65,62,25,81,47,1,49,13,14,53,51,25,25,2,22,4,47,2,4,1,4,23,58,47,13,29,1,39,76,60,2,35,2,84,15,38,49,40,44,1,66,22,20,9,33,2,7,17,3,12,30,16,43,40,1,57,48,23,1,0,1,82,1,18,15,49,11,26,6,38,37,18,18,24,42,2,45,83,17,54,16,28,69,26,35,41,27,50,24,30,67,44,1,11,1,45,42,1,67,1,84,37,39,42,44,44,11,60,2,14,2,44,62,61,10,27,49,11,51,73,0,13,57,38,51,2,66,33,44,2,2,55,36,39,53,42,16,8,1,32,18,1,27,29,58,18,23,1,61,1,44,2,3,1,70,1,26,46,10,25,1,16,18,5,37,1,7,20,24,60,54,40,50,35,83,1,44,55,80,54,65,81,38,50,57,51,46,89,68,77,53,3,5,56,25,86,41,80,60,46,62,77,84,57,62,73,63,60,55,41,63,80,76,62,5,37,56,63,87,74,56,70,47,56,84,43,22,49,74,12,71,43,74,60,48,77,63,67,41,61,1,60,70,52,68,44,59,71,86,85,53,23,75,85,61,60,45,84,84,8,26,46,20,46,73,89,82,71,79,53,64,42,80,82,57,87,6,88,44,37,27,78,61,84,21,65,49,29,80,84,39,82,35,74,83,46,54,59,71,78,82,86,2,43,61,51,90,51,2,45,58,68,9,59,50,35,57,65,55,53,85,43,84,34,59,86,47,41)
    
  # 1. Histogram of the Duration 1000 Data (notice distribution is skewed right)
  hist(x)

  # 2. Q-Q Plot of Duration 1000 Data(x) (notice distribution is not normal)
  qqnorm(x)
  qqline(x)
  
  # 3. Select 40 random samples of size 10 from x
  sample10 = replicate(40, sample(x, 10, replace = T))

  # 4. Select 40 random samples of size 50 from x
  sample50 = replicate(40, sample(x, 50, replace = T))
  
  # 5. Find the means and standard deviations of the samples recorded in Step 3 and Step 4 above
  mean10 = apply(sample10, MARGIN = 2, FUN = mean)
  mean10
  sd10 = apply(sample10, 2, sd)
  sd10
  mean50 = apply(sample50, 2, mean)
  mean50
  sd50 = apply(sample50, 2, sd)
  sd50
  
  # 6 Draw histogram and QQ-plots for both the variables obtained in step 5 (sample means and standard deviations)
  hist(mean10)
  hist(mean50)
  hist(sd10)
  hist(sd50)
  qqnorm(mean10)
  qqline(mean10)
  qqnorm(mean50)
  qqline(mean50)
  qqnorm(sd10)
  qqline(sd10)
  qqnorm(sd50)
  qqline(sd50)
  
  # 7. Compare the results (means and standard deviations) of step 1 and step 6 in the light of unbiasedness and consistancy
        # MU for the population
        mean(x)
        
        # SIGMA for the population
        sd(x)
        
        # MU X-BAR for n=10
        mean(mean10)
        
        # MU X-BAR for n=50
        mean(mean50)
        # Means are close to MU, hence X-BAR is an unbiased estimate
        
        # SIGMA for the population
        sd(x)
        
        sd(mean10)
        sd(mean50)
        # As n increases, standard deviation decreases, hence X-BAR is consistent in estimating SIGMA

# 8.Compare the histograms on Step 1 and Step 6 in the light of the Central Limit Theorem.
        # Histograms for X-BAR and s are more symmetric compared to the population

# 9. Compare the Q-Q plots on Step 2 and Step 6 in the light of the Central Limit Theorem.
        # Distributions for X-BAR and s are closer to Normal compared to the populations

        